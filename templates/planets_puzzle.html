<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü™ê –ö–æ—Å–º–∏—á–µ—Å–∫–∏–µ –ø–∞–∑–ª—ã - –°–æ–±–µ—Ä–∏ –ø–ª–∞–Ω–µ—Ç—ã!</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .puzzle-container {
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
            background: rgba(10, 0, 30, 0.85);
            border-radius: 20px;
            border: 4px solid #00ffff;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
            text-align: center;
        }

        .puzzle-title {
            font-size: 2.2rem;
            color: #ffff00;
            margin-bottom: 15px;
            text-shadow: 0 0 10px yellow;
            font-family: 'Comic Sans MS', cursive;
        }

        .game-explanation {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
            border: 2px dashed #ff00ff;
        }

        .explanation-text {
            color: white;
            font-size: 1.1rem;
            line-height: 1.4;
            margin-bottom: 10px;
        }

        .game-area {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
            min-height: 180px;
        }

        .puzzle-piece {
            width: 100%;
            height: 160px;
            background: linear-gradient(135deg, rgba(255, 100, 255, 0.2), rgba(100, 200, 255, 0.2));
            border: 3px solid #ff00ff;
            border-radius: 15px;
            cursor: grab;
            overflow: hidden;
            position: relative;
            transition: all 0.3s;
        }

        .puzzle-piece:hover {
            transform: scale(1.05);
            border-color: #00ffff;
            box-shadow: 0 0 15px #00ffff;
        }

        .planet-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .image-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(255,0,255,0.3), rgba(0,255,255,0.3));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: white;
        }

        .puzzle-board-container {
            width: 100%;
            max-width: 900px;
            margin: 20px auto;
            position: relative;
        }

        .puzzle-board {
            width: 100%;
            height: 550px;
            background: rgba(0, 10, 30, 0.5);
            border: 4px dashed #00ffaa;
            border-radius: 20px;
            position: relative;
            overflow: auto;
            background-image: radial-gradient(circle at 10% 20%, rgba(0, 40, 80, 0.3) 0%, transparent 20%),
                              radial-gradient(circle at 90% 80%, rgba(100, 0, 100, 0.3) 0%, transparent 20%);
        }

        .board-inner {
            min-width: 850px;
            min-height: 550px;
            position: relative;
        }

        .drop-zone {
            position: absolute;
            width: 180px;
            height: 180px;
            border: 3px dashed rgba(255, 255, 255, 0.5);
            border-radius: 15px;
            background: rgba(0, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            padding-bottom: 40px;
        }

        .drop-zone:hover {
            background: rgba(0, 255, 255, 0.2);
            border-color: white;
        }

        .zone-label {
            color: #ffcc00;
            font-size: 1.3rem;
            font-weight: bold;
            position: absolute;
            bottom: 5px;
            left: 0;
            right: 0;
            text-align: center;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 5px;
            border-radius: 8px;
            margin: 0 5px;
            text-shadow: 0 0 3px black;
            min-height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .game-info {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
            padding: 15px;
            background: linear-gradient(90deg, rgba(255, 0, 255, 0.1), rgba(0, 255, 255, 0.1));
            border-radius: 15px;
        }

        .info-box {
            text-align: center;
        }

        .info-label {
            color: #ffcc00;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .score {
            font-size: 2rem;
            color: #ffff00;
            text-shadow: 0 0 8px yellow;
        }

        .timer {
            font-size: 1.8rem;
            color: #00ffff;
            text-shadow: 0 0 8px cyan;
        }

        .level {
            font-size: 1.8rem;
            color: #00ffaa;
            text-shadow: 0 0 8px lime;
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .control-btn {
            padding: 15px 25px;
            background: linear-gradient(45deg, #ff00ff, #00ffff);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 0, 255, 0.4);
        }

        /* –î–≤–∞ —Ç–∏–ø–∞ —Å–æ–æ–±—â–µ–Ω–∏–π */
        .message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 40, 0.95);
            color: white;
            padding: 30px;
            border-radius: 25px;
            border: 4px solid gold;
            box-shadow: 0 0 40px gold;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 350px;
        }

        .hint-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 40, 0.95);
            color: white;
            padding: 25px;
            border-radius: 20px;
            border: 3px solid #00ffff;
            box-shadow: 0 0 30px #00ffff;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 300px;
        }

        .star-reward {
            animation: float 3s ease-in-out infinite;
            color: gold;
            font-size: 2.5rem;
            margin: 8px;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .success-animation {
            animation: success 1s ease-out;
        }

        @keyframes success {
            0% { transform: scale(0.5); opacity: 0; }
            70% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .hint {
            color: #ffcc00;
            font-size: 0.9rem;
            margin-top: 8px;
            font-style: italic;
        }

        .board-title {
            position: absolute;
            top: 10px;
            left: 0;
            right: 0;
            color: rgba(255, 255, 255, 0.5);
            font-size: 1.2rem;
            text-align: center;
            z-index: 1;
        }

        .scroll-hint {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.9rem;
            margin-top: 10px;
            font-style: italic;
        }

        .puzzle-board::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        .puzzle-board::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .puzzle-board::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #00ffff, #ff00ff);
            border-radius: 10px;
        }

        .puzzle-board::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #ff00ff, #00ffff);
        }
    </style>
</head>
<body class="kid-mode">
    <div class="starfield"></div>

    <button class="back-button" onclick="window.location.href='/games'" style="position: fixed; top: 20px; left: 20px; padding: 12px 20px; background: linear-gradient(45deg, #ff0066, #ff5500); color: white; border: none; border-radius: 15px; font-size: 1rem; cursor: pointer; z-index: 1000; display: flex; align-items: center; gap: 8px; transition: all 0.3s;">
        ‚Üê –ù–∞–∑–∞–¥
    </button>

    <div class="puzzle-container">
        <h1 class="puzzle-title">ü™ê –ö–û–°–ú–ò–ß–ï–°–ö–ò–ï –ü–ê–ó–õ–´</h1>

        <!-- –î–û–ë–ê–í–õ–ï–ù–ù–û–ï –í–ò–î–ï–û –ó–î–ï–°–¨ -->
        <div class="game-explanation" style="margin-bottom: 25px;">
            <h3 style="color: #00ffff; margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
                üé¨ –ü–æ—Å–º–æ—Ç—Ä–∏ –ø–µ—Ä–µ–¥ –∏–≥—Ä–æ–π!
            </h3>
            <video width="100%" controls style="border-radius: 12px; border: 3px solid #ff00ff;">
                <source src="{{ url_for('static', filename='videos/—Ç—Ç.mp4') }}" type="video/mp4">
                –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
            </video>
            <p style="color: #ffcc00; margin-top: 8px; font-size: 0.9rem;">
                üí° –ü–æ—Å–º–æ—Ç—Ä–∏ —ç—Ç–æ –≤–∏–¥–µ–æ, —á—Ç–æ–±—ã –ª—É—á—à–µ —É–∑–Ω–∞—Ç—å –ø–ª–∞–Ω–µ—Ç—ã!
            </p>
        </div>

        <div class="game-explanation">
            <div class="explanation-text">
                <strong>üéØ –ó–∞–¥–∞–Ω–∏–µ:</strong> –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –ø–ª–∞–Ω–µ—Ç—É –∏ –Ω–∞–π–¥–∏ –µ—ë –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ!
            </div>
            <div class="explanation-text">
                <strong>‚ú® –ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</strong><br>
                1. üëÜ –í–æ–∑—å–º–∏ –ª—é–±—É—é –ø–ª–∞–Ω–µ—Ç—É<br>
                2. üîç –ü–æ—Å–º–æ—Ç—Ä–∏ –∫–∞–∫ –æ–Ω–∞ –≤—ã–≥–ª—è–¥–∏—Ç<br>
                3. üéØ –ù–∞–π–¥–∏ –µ—ë –Ω–∞–∑–≤–∞–Ω–∏–µ –≤ –∫–æ—Å–º–æ—Å–µ<br>
                4. ‚úÖ –ü–µ—Ä–µ—Ç–∞—â–∏ –ø–ª–∞–Ω–µ—Ç—É –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è!
            </div>
            <div class="hint">–ü–ª–∞–Ω–µ—Ç—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤ —Ä–∞–∑–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ! –ë—É–¥—å –≤–Ω–∏–º–∞—Ç–µ–ª–µ–Ω!</div>
        </div>

        <div class="game-info">
            <div class="info-box">
                <div class="info-label">üéØ –°–æ–±—Ä–∞–Ω–æ:</div>
                <div class="score" id="score">0/12</div>
            </div>
            <div class="info-box">
                <div class="info-label">‚è±Ô∏è –í—Ä–µ–º—è:</div>
                <div class="timer" id="timer">02:00</div>
            </div>
            <div class="info-box">
                <div class="info-label">üöÄ –£—Ä–æ–≤–µ–Ω—å:</div>
                <div class="level" id="level">1</div>
            </div>
        </div>

        <div class="game-area" id="puzzle-pieces">
            <!-- –ü–∞–∑–ª—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
        </div>

        <div class="puzzle-board-container">
            <div class="puzzle-board" id="puzzle-board">
                <div class="board-inner" id="board-inner">
                    <div class="board-title">üåå –ö–û–°–ú–ò–ß–ï–°–ö–ê–Ø –ö–ê–†–¢–ê üöÄ</div>
                    <!-- –ó–æ–Ω—ã –¥–ª—è –ø–∞–∑–ª–æ–≤ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            <div class="scroll-hint">üí° –ï—Å–ª–∏ –Ω–µ –≤–∏–¥–∏—à—å –≤—Å–µ –ø–ª–∞–Ω–µ—Ç—ã - –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–π –∫–∞—Ä—Ç—É!</div>
        </div>

        <div class="controls">
            <button class="control-btn" onclick="startGame()">‚ñ∂Ô∏è –ù–ê–ß–ê–¢–¨</button>
            <button class="control-btn" onclick="resetGame()">üîÑ –ó–ê–ù–û–í–û</button>
            <button class="control-btn" onclick="window.location.href='/games'">üè† –í–´–ô–¢–ò</button>
        </div>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–≥—Ä—ã (—Å –∫–Ω–æ–ø–∫–æ–π –í–ï–†–ù–£–¢–¨–°–Ø) -->
    <div class="message" id="message">
        <h2 style="color: gold; margin-bottom: 15px; font-size: 2rem;" id="message-title">üéâ –ü–û–ë–ï–î–ê!</h2>
        <p style="font-size: 1.2rem; margin-bottom: 15px;" id="message-text"></p>
        <div id="reward-stars"></div>
        <button onclick="window.location.href='/games'" style="margin-top: 20px; padding: 12px 25px; background: linear-gradient(45deg, gold, orange); color: black; border: none; border-radius: 12px; font-size: 1.1rem; cursor: pointer; font-weight: bold;">
            üèÜ –í–ï–†–ù–£–¢–¨–°–Ø
        </button>
    </div>

    <!-- –í—Å–ø–ª—ã–≤–∞—é—â–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ (–ë–ï–ó –∫–Ω–æ–ø–∫–∏ –í–ï–†–ù–£–¢–¨–°–Ø) -->
    <div class="hint-message" id="hint-message">
        <h3 style="color: #00ffff; margin-bottom: 10px; font-size: 1.5rem;" id="hint-title"></h3>
        <p style="font-size: 1.1rem;" id="hint-text"></p>
    </div>

    <script>
        // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π JavaScript –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        let score = 0;
        let timeLeft = 120;
        let gameActive = false;
        let timerInterval;

        const planets = [
            {name: '–ó–µ–º–ª—è', id: 'earth'},
            {name: '–ú–∞—Ä—Å', id: 'mars'},
            {name: '–Æ–ø–∏—Ç–µ—Ä', id: 'jupiter'},
            {name: '–°–∞—Ç—É—Ä–Ω', id: 'saturn'},
            {name: '–í–µ–Ω–µ—Ä–∞', id: 'venus'},
            {name: '–ú–µ—Ä–∫—É—Ä–∏–π', id: 'mercury'},
            {name: '–£—Ä–∞–Ω', id: 'uranus'},
            {name: '–ù–µ–ø—Ç—É–Ω', id: 'neptune'},
            {name: '–õ—É–Ω–∞', id: 'moon'},
            {name: '–°–æ–ª–Ω—Ü–µ', id: 'sun'},
            {name: '–ü–ª—É—Ç–æ–Ω', id: 'pluto'},
            {name: '–ö–æ–º–µ—Ç–∞', id: 'comet'}
        ];

        let draggedPlanet = null;

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        let currentPlanetsOrder = [];

        function createPuzzle() {
            const piecesContainer = document.getElementById('puzzle-pieces');
            const boardInner = document.getElementById('board-inner');

            piecesContainer.innerHTML = '';
            boardInner.innerHTML = '<div class="board-title">üåå –ö–û–°–ú–ò–ß–ï–°–ö–ê–Ø –ö–ê–†–¢–ê üöÄ</div>';

            currentPlanetsOrder = shuffleArray([...planets]);
            const dropZones = [...planets];

            // –°–æ–∑–¥–∞–µ–º –∫—É—Å–æ—á–∫–∏ –ø–∞–∑–ª–æ–≤
            currentPlanetsOrder.forEach((planet) => {
                const piece = document.createElement('div');
                piece.className = 'puzzle-piece';
                piece.draggable = true;
                piece.dataset.id = planet.id;
                piece.dataset.name = planet.name;

                piece.innerHTML = `
                    <img class="planet-image"
                         src="/static/game_images/planets/${planet.id}.png"
                         alt="${planet.name}"
                         onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=\"image-placeholder\">ü™ê</div>';">
                `;

                piece.addEventListener('mousedown', () => {
                    draggedPlanet = planet;
                });

                piece.addEventListener('touchstart', () => {
                    draggedPlanet = planet;
                });

                piece.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', planet.id);
                    e.dataTransfer.setData('name', planet.name);
                    draggedPlanet = planet;
                });

                piecesContainer.appendChild(piece);
            });

            // –°–æ–∑–¥–∞–µ–º –∑–æ–Ω—ã –¥–ª—è —Å–±—Ä–æ—Å–∞
            dropZones.forEach((planet, index) => {
                const zone = document.createElement('div');
                zone.className = 'drop-zone';
                zone.dataset.id = planet.id;
                zone.dataset.name = planet.name;

                const col = index % 4;
                const row = Math.floor(index / 4);

                zone.style.left = (col * 200 + 30) + 'px';
                zone.style.top = (row * 200 + 50) + 'px';

                zone.innerHTML = `<div class="zone-label">${planet.name}</div>`;

                zone.addEventListener('dragover', (e) => e.preventDefault());
                zone.addEventListener('drop', handleDrop);
                zone.addEventListener('dragenter', (e) => {
                    e.preventDefault();
                    zone.style.background = 'rgba(0, 255, 255, 0.3)';
                    zone.style.borderColor = 'white';
                });
                zone.addEventListener('dragleave', () => {
                    zone.style.background = 'rgba(0, 255, 255, 0.1)';
                    zone.style.borderColor = 'rgba(255, 255, 255, 0.5)';
                });

                boardInner.appendChild(zone);
            });

            const innerWidth = 4 * 200 + 60;
            const innerHeight = 3 * 200 + 100;

            boardInner.style.minWidth = innerWidth + 'px';
            boardInner.style.minHeight = innerHeight + 'px';

            startTimer();
        }

        function handleDrop(e) {
            e.preventDefault();

            let planetId, planetName;

            if (draggedPlanet) {
                planetId = draggedPlanet.id;
                planetName = draggedPlanet.name;
            } else {
                planetId = e.dataTransfer.getData('text/plain');
                planetName = e.dataTransfer.getData('name') || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø–ª–∞–Ω–µ—Ç–∞';
            }

            const zone = e.target.closest('.drop-zone');

            if (!zone || !planetId) return;

            zone.style.background = 'rgba(0, 255, 255, 0.1)';
            zone.style.borderColor = 'rgba(255, 255, 255, 0.5)';

            if (zone.dataset.id === planetId) {
                // –£–°–ü–ï–•!
                zone.style.background = 'rgba(0, 255, 0, 0.3)';
                zone.style.border = '3px solid #00ff00';
                zone.style.boxShadow = '0 0 20px #00ff00';
                zone.innerHTML = `
                    <div style="font-size: 4rem; margin-top: 30px;">‚úÖ</div>
                    <div class="zone-label" style="color: #00ff00; background: rgba(0, 100, 0, 0.8);">
                        ‚úì ${planetName}
                    </div>
                `;
                zone.classList.add('success-animation');

                score++;
                document.getElementById('score').textContent = `${score}/12`;
                document.getElementById('score').classList.add('success-animation');

                const piece = document.querySelector(`.puzzle-piece[data-id="${planetId}"]:not([style*="opacity: 0.3"])`);
                if (piece) {
                    piece.style.opacity = '0.3';
                    piece.style.pointerEvents = 'none';
                    piece.style.transform = 'scale(0.9)';
                    piece.style.borderColor = '#00ff00';
                    piece.style.cursor = 'default';
                }

                addStar();

                if (score === 12) {
                    setTimeout(() => endGame(true), 500);
                }
            } else {
                // –û–®–ò–ë–ö–ê - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –ë–ï–ó –∫–Ω–æ–ø–∫–∏
                showHint(`‚ùå –≠—Ç–æ ${planetName}, –∞ –∑–¥–µ—Å—å –Ω—É–∂–Ω–æ ${zone.dataset.name}`, '–û–®–ò–ë–ö–ê!');

                zone.style.background = 'rgba(255, 0, 0, 0.3)';
                zone.style.border = '3px solid #ff0000';
                setTimeout(() => {
                    zone.style.background = 'rgba(0, 255, 255, 0.1)';
                    zone.style.border = '3px dashed rgba(255, 255, 255, 0.5)';
                }, 1000);

                if (navigator.vibrate) {
                    navigator.vibrate(200);
                }
            }

            draggedPlanet = null;
        }

        function startTimer() {
            clearInterval(timerInterval);
            timeLeft = 120;
            updateTimer();

            timerInterval = setInterval(() => {
                if (!gameActive) return;

                timeLeft--;
                updateTimer();

                if (timeLeft <= 30) {
                    document.getElementById('timer').style.color = '#ff5555';
                    document.getElementById('timer').style.textShadow = '0 0 8px red';
                }

                if (timeLeft <= 0) {
                    endGame(false);
                }
            }, 1000);
        }

        function updateTimer() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timer').textContent =
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function startGame() {
            gameActive = true;
            score = 0;
            document.getElementById('score').textContent = '0/12';
            document.getElementById('score').style.color = '#ffff00';
            document.getElementById('timer').style.color = '#00ffff';

            createPuzzle();

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ë–ï–ó –∫–Ω–æ–ø–∫–∏
            showHint('üöÄ –ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å!<br>–ù–∞–π–¥–∏ –≤—Å–µ –ø–ª–∞–Ω–µ—Ç—ã!', 'üåå –°–¢–ê–†–¢!');
        }

        function resetGame() {
            gameActive = false;
            clearInterval(timerInterval);
            score = 0;
            document.getElementById('score').textContent = '0/12';
            timeLeft = 120;
            updateTimer();

            createPuzzle();

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ë–ï–ó –∫–Ω–æ–ø–∫–∏
            showHint('üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞!<br>–ü–æ–ø—Ä–æ–±—É–π –ø–æ–±–∏—Ç—å —Å–≤–æ–π —Ä–µ–∫–æ—Ä–¥!', 'ü™ê –ó–ê–ù–û–í–û!');
        }

        function endGame(win) {
            gameActive = false;
            clearInterval(timerInterval);

            const message = document.getElementById('message');
            const title = document.getElementById('message-title');
            const text = document.getElementById('message-text');
            const stars = document.getElementById('reward-stars');

            if (win) {
                const timeUsed = 120 - timeLeft;
                title.innerHTML = 'üéâ –£–†–ê! –¢–´ –°–ü–†–ê–í–ò–õ–°–Ø!';
                text.innerHTML = `–¢—ã —Å–æ–±—Ä–∞–ª –≤—Å–µ –ø–ª–∞–Ω–µ—Ç—ã –∑–∞ ${timeUsed} —Å–µ–∫—É–Ω–¥!`;

                stars.innerHTML = '';
                const starCount = Math.max(5, Math.floor(120 / timeUsed) * 2);
                for (let i = 0; i < starCount; i++) {
                    setTimeout(() => {
                        const star = document.createElement('div');
                        star.className = 'star-reward';
                        star.innerHTML = '‚≠ê';
                        stars.appendChild(star);
                    }, i * 200);
                }

                fetch('/add_star', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({count: starCount, reason: '–°–æ–±—Ä–∞–ª –≤—Å–µ –∫–æ—Å–º–∏—á–µ—Å–∫–∏–µ –ø–∞–∑–ª—ã'})
                });
            } else {
                title.innerHTML = '‚è∞ –í–†–ï–ú–Ø –í–´–®–õ–û!';
                text.innerHTML = `–°–æ–±—Ä–∞–Ω–æ ${score} –∏–∑ 12 –ø–ª–∞–Ω–µ—Ç.<br>–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑!`;
                stars.innerHTML = '<div style="font-size: 1.5rem; color: silver;">–ù–µ —Å–¥–∞–≤–∞–π—Å—è! üöÄ</div>';
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –° –∫–Ω–æ–ø–∫–æ–π
            message.style.display = 'block';
        }

        function addStar() {
            fetch('/add_star', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({count: 1, reason: '–ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞–∑–º–µ—Å—Ç–∏–ª –ø–ª–∞–Ω–µ—Ç—É'})
            });
        }

        // –ü–æ–∫–∞–∑ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –ë–ï–ó –∫–Ω–æ–ø–∫–∏
        function showHint(text, title = 'üí´ –í–ù–ò–ú–ê–ù–ò–ï!') {
            const hint = document.getElementById('hint-message');
            document.getElementById('hint-title').innerHTML = title;
            document.getElementById('hint-text').innerHTML = text;
            hint.style.display = 'block';

            setTimeout(() => {
                hint.style.display = 'none';
            }, 2000);
        }

        document.addEventListener('DOMContentLoaded', () => {
            createPuzzle();
            showHint(
                '–ü—Ä–∏–≤–µ—Ç, –∫–æ—Å–º–æ–Ω–∞–≤—Ç!<br>' +
                '–°–æ–±–µ—Ä–∏ –≤—Å–µ –ø–ª–∞–Ω–µ—Ç—ã –∑–∞ 2 –º–∏–Ω—É—Ç—ã!<br>' +
                'üí° –ö–∞—Ä—Ç—É –º–æ–∂–Ω–æ –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞—Ç—å!',
                'üöÄ –î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨!'
            );
        });
    </script>
</body>
</html>