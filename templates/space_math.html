<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ –ö–æ—Å–º–∏—á–µ—Å–∫–∏–π —Å—á—ë—Ç</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0a0a2a, #1a1a4a, #2a2a6a);
            min-height: 100vh;
            overflow-x: hidden;
            color: white;
        }

        .starfield {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite alternate;
        }

        @keyframes twinkle {
            0% { opacity: 0.2; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }

        .planet {
            position: fixed;
            border-radius: 50%;
            filter: blur(2px);
            z-index: -1;
        }

        .planet1 {
            width: 300px;
            height: 300px;
            top: 10%;
            right: 5%;
            background: radial-gradient(circle at 30% 30%, #ff9966, #ff5e62);
            box-shadow: 0 0 100px rgba(255, 94, 98, 0.5);
        }

        .planet2 {
            width: 200px;
            height: 200px;
            bottom: 15%;
            left: 5%;
            background: radial-gradient(circle at 40% 40%, #6a11cb, #2575fc);
            box-shadow: 0 0 80px rgba(37, 117, 252, 0.4);
        }

        /* –ö–ù–û–ü–ö–ê –ù–ê–ó–ê–î */
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 15px 25px;
            background: linear-gradient(45deg, #ff0066, #ff5500);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 1.1rem;
            cursor: pointer;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 4px 20px rgba(255, 0, 102, 0.3);
            backdrop-filter: blur(10px);
        }

        .back-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(255, 0, 102, 0.5);
        }

        /* –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† */
        .math-game {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* –ó–ê–ì–û–õ–û–í–û–ö */
        .game-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 30px;
            border: 3px solid #00ffff;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }

        .game-title {
            font-size: 3.5rem;
            color: #ffff00;
            margin-bottom: 20px;
            text-shadow: 0 0 15px yellow, 0 0 30px orange;
            font-family: 'Comic Sans MS', cursive;
            animation: titleGlow 2s infinite alternate;
        }

        @keyframes titleGlow {
            0% { text-shadow: 0 0 15px yellow; }
            100% { text-shadow: 0 0 25px yellow, 0 0 40px orange; }
        }

        .game-subtitle {
            color: #00ffff;
            font-size: 1.3rem;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* –ü–õ–ê–ù–ï–¢–ê –ò –†–ê–ö–ï–¢–ê */
        .planet-display {
            position: relative;
            width: 100%;
            height: 400px;
            margin: 40px auto;
            background: linear-gradient(0deg, #000428, #004e92);
            border-radius: 30px;
            overflow: hidden;
            border: 4px solid #ff00ff;
            box-shadow: 0 0 40px rgba(255, 0, 255, 0.4);
        }

        .moon {
            position: absolute;
            top: 50px;
            right: 50px;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle at 30% 30%, #cccccc, #999999);
            border-radius: 50%;
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.6);
            animation: moonGlow 3s infinite alternate;
        }

        @keyframes moonGlow {
            0% { box-shadow: 0 0 40px rgba(255, 255, 255, 0.6); }
            100% { box-shadow: 0 0 60px rgba(255, 255, 255, 0.8); }
        }

        .rocket-container {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            transition: all 1s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .rocket {
            font-size: 5rem;
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
            animation: rocketFloat 2s infinite alternate;
        }

        @keyframes rocketFloat {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(-10px) rotate(2deg); }
        }

        .rocket-trail {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 10px;
            height: 100px;
            background: linear-gradient(to top, rgba(255, 255, 255, 0), #ff5500);
            filter: blur(3px);
        }

        /* –®–ö–ê–õ–ê –¢–û–ü–õ–ò–í–ê */
        .fuel-container {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 15px;
            border: 2px solid #00ffff;
            backdrop-filter: blur(5px);
        }

        .fuel-label {
            color: #00ffff;
            font-size: 1.1rem;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .fuel-bar {
            height: 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .fuel-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ff8800, #ffff00, #00ff00);
            width: 100%;
            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            border-radius: 12px;
            position: relative;
        }

        .fuel-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg,
                transparent 0%,
                rgba(255, 255, 255, 0.2) 50%,
                transparent 100%);
            animation: fuelShine 2s infinite;
        }

        @keyframes fuelShine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* –°–¢–ê–¢–ò–°–¢–ò–ö–ê */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 40px 0;
        }

        @media (max-width: 768px) {
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            border: 2px solid;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card:nth-child(1) { border-color: #00ffff; }
        .stat-card:nth-child(2) { border-color: #ffff00; }
        .stat-card:nth-child(3) { border-color: #ff00ff; }
        .stat-card:nth-child(4) { border-color: #00ffaa; }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
            text-shadow: 0 0 10px currentColor;
        }

        .stat-card:nth-child(1) .stat-value { color: #00ffff; }
        .stat-card:nth-child(2) .stat-value { color: #ffff00; }
        .stat-card:nth-child(3) .stat-value { color: #ff00ff; }
        .stat-card:nth-child(4) .stat-value { color: #00ffaa; }

        .stat-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
        }

        /* –ó–û–ù–ê –ó–ê–î–ê–ß–ò */
        .problem-container {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 30px;
            padding: 40px;
            margin: 40px 0;
            border: 3px solid #ffff00;
            box-shadow: 0 0 30px rgba(255, 255, 0, 0.3);
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .problem-header {
            color: #00ffaa;
            font-size: 1.5rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .problem-display {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            border: 2px solid #00ffff;
        }

        .problem {
            font-size: 4rem;
            color: white;
            margin: 20px 0;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            font-weight: bold;
        }

        .problem-info {
            color: #aaa;
            font-size: 1.1rem;
            margin-top: 20px;
        }

        /* –í–ê–†–ò–ê–ù–¢–´ –û–¢–í–ï–¢–û–í */
        .answers-section {
            margin: 40px 0;
        }

        .answers-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        @media (max-width: 600px) {
            .answers-grid {
                grid-template-columns: 1fr;
            }
        }

        .answer-btn {
            padding: 25px;
            font-size: 2.2rem;
            background: linear-gradient(135deg, #1a1a4a, #2a2a6a);
            border: 3px solid #00ffff;
            border-radius: 20px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }

        .answer-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                transparent,
                rgba(255, 255, 255, 0.1),
                transparent);
            transition: 0.5s;
        }

        .answer-btn:hover::before {
            left: 100%;
        }

        .answer-btn:hover {
            transform: translateY(-5px) scale(1.05);
            border-color: #ffff00;
            box-shadow: 0 5px 25px rgba(255, 255, 0, 0.3);
            background: linear-gradient(135deg, #2a2a6a, #3a3a8a);
        }

        .answer-btn.correct {
            background: linear-gradient(135deg, #00aa00, #00ff88);
            border-color: #00ff00;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.5);
            animation: correctPulse 0.5s;
        }

        .answer-btn.wrong {
            background: linear-gradient(135deg, #aa0000, #ff5555);
            border-color: #ff0000;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.5);
            animation: wrongShake 0.5s;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* –ü–û–õ–ï –í–í–û–î–ê */
        .input-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid #ff00ff;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 500px;
            margin: 0 auto;
        }

        .answer-input {
            font-size: 2.5rem;
            padding: 20px;
            width: 200px;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            border: 3px solid #00ffff;
            border-radius: 15px;
            color: white;
            transition: all 0.3s;
        }

        .answer-input:focus {
            outline: none;
            border-color: #ffff00;
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.3);
            transform: scale(1.05);
        }

        .check-btn {
            padding: 18px 40px;
            background: linear-gradient(45deg, #00aa00, #00ff88);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .check-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0, 255, 136, 0.4);
            background: linear-gradient(45deg, #00ff88, #00aa00);
        }

        /* –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø */
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 20px 35px;
            background: linear-gradient(45deg, #ff00ff, #00ffff);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 200px;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(255, 0, 255, 0.3);
        }

        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(255, 0, 255, 0.5);
        }

        .control-btn:nth-child(2) {
            background: linear-gradient(45deg, #00ffff, #0088ff);
        }

        .control-btn:nth-child(2):hover {
            box-shadow: 0 6px 25px rgba(0, 136, 255, 0.5);
        }

        .control-btn:nth-child(3) {
            background: linear-gradient(45deg, #ff5500, #ffaa00);
        }

        .control-btn:nth-child(3):hover {
            box-shadow: 0 6px 25px rgba(255, 85, 0, 0.5);
        }

        /* –í–°–ü–õ–´–í–ê–Æ–©–ò–ï –°–û–û–ë–©–ï–ù–ò–Ø */
        .message-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
        }

        .message-box {
            background: linear-gradient(135deg, #0a0a2a, #1a1a4a);
            border-radius: 30px;
            padding: 50px;
            text-align: center;
            border: 4px solid;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 0 50px rgba(255, 255, 0, 0.5);
            animation: messageAppear 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes messageAppear {
            0% { transform: scale(0.5) rotate(-10deg); opacity: 0; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        .message-title {
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 0 0 15px currentColor;
        }

        .win-title {
            color: gold;
            border-color: gold;
        }

        .lose-title {
            color: #ff5555;
            border-color: #ff5555;
        }

        .message-text {
            font-size: 1.3rem;
            margin-bottom: 30px;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.9);
        }

        .message-stats {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            font-size: 1.1rem;
            line-height: 1.8;
        }

        .message-btn {
            padding: 15px 40px;
            background: linear-gradient(45deg, gold, orange);
            color: black;
            border: none;
            border-radius: 20px;
            font-size: 1.2rem;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .message-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(255, 165, 0, 0.5);
        }

        /* –ê–ù–ò–ú–ê–¶–ò–ò */
        @keyframes rocketLaunch {
            0% { transform: translateY(0); }
            100% { transform: translateY(-100vh); }
        }

        .rocket-launch {
            animation: rocketLaunch 2s forwards cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* –°–ü–ò–ö–ï–†–´ (TOOLTIPS) */
        .control-btn[title],
        .check-btn[title] {
            position: relative;
        }

        .control-btn[title]:hover::after,
        .check-btn[title]:hover::after {
            content: attr(title);
            position: absolute;
            bottom: 130%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 40, 0.95);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 0.9rem;
            white-space: nowrap;
            z-index: 1000;
            border: 2px solid #00ffff;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
            pointer-events: none;
            backdrop-filter: blur(5px);
        }

        .control-btn[title]:hover::before,
        .check-btn[title]:hover::before {
            content: '';
            position: absolute;
            bottom: 120%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: #00ffff;
            z-index: 1000;
        }

        /* –°–í–ï–¢–Ø–©–ò–ï–°–Ø –ó–í–ï–ó–î–´ */
        .floating-star {
            position: absolute;
            background: radial-gradient(circle, #fff 0%, transparent 70%);
            border-radius: 50%;
            animation: floatStar 20s linear infinite;
            opacity: 0.7;
        }

        @keyframes floatStar {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* –î–û–°–¢–ò–ñ–ï–ù–ò–Ø */
        .achievements {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .achievement {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            opacity: 0.3;
            transition: all 0.3s;
        }

        .achievement.unlocked {
            opacity: 1;
            background: rgba(255, 215, 0, 0.2);
            border: 2px solid gold;
            box-shadow: 0 0 15px gold;
            transform: scale(1.1);
        }

        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-width: 768px) {
            .game-title {
                font-size: 2.5rem;
            }

            .problem {
                font-size: 3rem;
            }

            .answer-btn {
                font-size: 1.8rem;
                padding: 20px;
            }

            .control-btn {
                min-width: 160px;
                padding: 15px 25px;
                font-size: 1rem;
            }

            .planet-display {
                height: 300px;
            }

            .rocket {
                font-size: 4rem;
            }
        }

        @media (max-width: 480px) {
            .game-title {
                font-size: 2rem;
            }

            .stats-container {
                gap: 15px;
            }

            .stat-card {
                padding: 20px;
            }

            .stat-value {
                font-size: 2rem;
            }

            .controls {
                flex-direction: column;
                align-items: center;
            }

            .control-btn {
                width: 100%;
                max-width: 300px;
            }
        }

        /* –≠–§–§–ï–ö–¢ –ü–û–õ–£–ß–ï–ù–ò–Ø –ó–í–ï–ó–î */
        .star-effect {
            position: fixed;
            pointer-events: none;
            z-index: 1000;
            animation: starPop 1s forwards;
        }

        @keyframes starPop {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 1;
            }
            50% {
                transform: scale(1.5) rotate(180deg);
                opacity: 1;
            }
            100% {
                transform: scale(0) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body class="math-game">
    <!-- –ó–í–ï–ó–î–ù–û–ï –ü–û–õ–ï -->
    <div class="starfield" id="starfield"></div>

    <!-- –ü–õ–ê–ù–ï–¢–´ -->
    <div class="planet planet1"></div>
    <div class="planet planet2"></div>

    <!-- –ö–ù–û–ü–ö–ê –ù–ê–ó–ê–î -->
    <button class="back-button" onclick="window.location.href='/games'" title="–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–±–æ—Ä—É –∏–≥—Ä">
        <i class="fas fa-arrow-left"></i> –ö –ò–ì–†–ê–ú
    </button>

    <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† -->
    <div class="math-game">
        <!-- –ó–ê–ì–û–õ–û–í–û–ö -->
        <div class="game-header">
            <h1 class="game-title">üöÄ –ö–û–°–ú–ò–ß–ï–°–ö–ò–ô –°–ß–Å–¢</h1>
            <div class="game-subtitle">
                –†–µ—à–∞–π –ø—Ä–∏–º–µ—Ä—ã, –∑–∞–ø—Ä–∞–≤–ª—è–π —Ä–∞–∫–µ—Ç—É —Ç–æ–ø–ª–∏–≤–æ–º –∏ –¥–æ–±–µ—Ä–∏—Å—å –¥–æ –õ—É–Ω—ã!
                –ß–µ–º –±–æ–ª—å—à–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ - —Ç–µ–º –±–æ–ª—å—à–µ –∑–≤—ë–∑–¥ –ø–æ–ª—É—á–∏—à—å! ‚ú®
            </div>
        </div>

        <!-- –ü–õ–ê–ù–ï–¢–ê –ò –†–ê–ö–ï–¢–ê -->
        <div class="planet-display">
            <!-- –õ–£–ù–ê -->
            <div class="moon">
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: black; font-size: 1.2rem; font-weight: bold; text-align: center;">
                    üåô<br>–¶–ï–õ–¨
                </div>
            </div>

            <!-- –†–ê–ö–ï–¢–ê -->
            <div class="rocket-container" id="rocketContainer">
                <div class="rocket" id="rocket">üöÄ</div>
                <div class="rocket-trail"></div>
            </div>

            <!-- –®–ö–ê–õ–ê –¢–û–ü–õ–ò–í–ê -->
            <div class="fuel-container">
                <div class="fuel-label">
                    <span>‚õΩ –¢–û–ü–õ–ò–í–û –†–ê–ö–ï–¢–´</span>
                    <span id="fuelPercent">100%</span>
                </div>
                <div class="fuel-bar">
                    <div class="fuel-fill" id="fuelFill"></div>
                </div>
            </div>

            <!-- –ó–í–ï–ó–î–´ –ù–ê –ü–£–¢–ò -->
            <div id="spaceStars"></div>
        </div>

        <!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-label">üåï –£–†–û–í–ï–ù–¨</div>
                <div class="stat-value" id="levelValue">1</div>
                <div class="stat-label">–°–ª–æ–∂–Ω–æ—Å—Ç—å</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û</div>
                <div class="stat-value" id="correctValue">0</div>
                <div class="stat-label">–û—Ç–≤–µ—Ç–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">‚ùå –û–®–ò–ë–û–ö</div>
                <div class="stat-value" id="wrongValue">0</div>
                <div class="stat-label">–ú–∞–∫—Å: 3</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">‚≠ê –ó–í–Å–ó–î–´</div>
                <div class="stat-value" id="starsValue">0</div>
                <div class="stat-label">–°–æ–±—Ä–∞–Ω–æ</div>
            </div>
        </div>

        <!-- –î–û–°–¢–ò–ñ–ï–ù–ò–Ø -->
        <div class="achievements" id="achievements">
            <div class="achievement" id="achieve1" title="–†–µ—à–∏—Ç—å 3 –ø—Ä–∏–º–µ—Ä–∞">3Ô∏è‚É£</div>
            <div class="achievement" id="achieve2" title="–†–µ—à–∏—Ç—å 5 –ø—Ä–∏–º–µ—Ä–æ–≤">5Ô∏è‚É£</div>
            <div class="achievement" id="achieve3" title="–†–µ—à–∏—Ç—å 10 –ø—Ä–∏–º–µ—Ä–æ–≤">üîü</div>
            <div class="achievement" id="achieve4" title="–î–æ–ª–µ—Ç–µ—Ç—å –¥–æ –õ—É–Ω—ã">üåô</div>
            <div class="achievement" id="achieve5" title="–ù–µ —Å–¥–µ–ª–∞—Ç—å –æ—à–∏–±–æ–∫">üíØ</div>
        </div>

        <!-- –ó–û–ù–ê –ó–ê–î–ê–ß–ò -->
        <div class="problem-container">
            <div class="problem-header">
                <i class="fas fa-calculator"></i>
                –†–ï–®–ò –ü–†–ò–ú–ï–†, –ß–¢–û–ë–´ –ó–ê–ü–†–ê–í–ò–¢–¨ –†–ê–ö–ï–¢–£:
            </div>

            <div class="problem-display">
                <div class="problem" id="problemDisplay">5 + 3 = ?</div>
                <div class="problem-info" id="problemInfo">
                    –£—Ä–æ–≤–µ–Ω—å 1 ‚Ä¢ –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–∏–º–µ—Ä—ã ‚Ä¢ +1 –∑–≤–µ–∑–¥–∞ –∑–∞ –æ—Ç–≤–µ—Ç
                </div>
            </div>

            <!-- –í–ê–†–ò–ê–ù–¢–´ –û–¢–í–ï–¢–û–í -->
            <div class="answers-section">
                <div class="answers-grid" id="answersGrid">
                    <!-- –û—Ç–≤–µ—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>

            <!-- –ü–û–õ–ï –î–õ–Ø –í–í–û–î–ê –û–¢–í–ï–¢–ê -->
            <div class="input-section">
                <div class="input-group">
                    <input type="number"
                           class="answer-input"
                           id="answerInput"
                           placeholder="–¢–≤–æ–π –æ—Ç–≤–µ—Ç"
                           onkeypress="handleKeyPress(event)">
                    <button class="check-btn" onclick="checkInputAnswer()" title="–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç (–∏–ª–∏ –Ω–∞–∂–º–∏ Enter)">
                        <i class="fas fa-check-circle"></i> –ü–†–û–í–ï–†–ò–¢–¨ –û–¢–í–ï–¢
                    </button>
                </div>
            </div>
        </div>

        <!-- –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø -->
        <div class="controls">
            <button class="control-btn" onclick="generateNewProblem()" title="–ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä">
                <i class="fas fa-redo"></i> –ù–û–í–´–ô –ü–†–ò–ú–ï–†
            </button>
            <button class="control-btn" onclick="resetGame()" title="–ù–∞—á–∞—Ç—å –∏–≥—Ä—É –∑–∞–Ω–æ–≤–æ">
                <i class="fas fa-rocket"></i> –ù–û–í–ê–Ø –ò–ì–†–ê
            </button>
            <button class="control-btn" onclick="window.location.href='/games'" title="–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–±–æ—Ä—É –∏–≥—Ä">
                <i class="fas fa-gamepad"></i> –í–´–ë–û–† –ò–ì–†
            </button>
        </div>
    </div>

    <!-- –°–û–û–ë–©–ï–ù–ò–ï –û –ü–û–ë–ï–î–ï -->
    <div class="message-overlay" id="winMessage">
        <div class="message-box" style="border-color: gold;">
            <div class="message-title win-title">üéâ –£–†–ê! –¢–´ –î–û–õ–ï–¢–ï–õ –î–û –õ–£–ù–´! üåô</div>
            <div class="message-text">
                –ú–æ–ª–æ–¥–µ—Ü! –¢—ã —É—Å–ø–µ—à–Ω–æ —Ä–µ—à–∏–ª –≤—Å–µ –ø—Ä–∏–º–µ—Ä—ã –∏ –∑–∞–ø—Ä–∞–≤–∏–ª —Ä–∞–∫–µ—Ç—É!
            </div>
            <div class="message-stats" id="winStats">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ -->
            </div>
            <button class="message-btn" onclick="closeMessage('winMessage'); resetGame();">
                <i class="fas fa-play"></i> –ò–ì–†–ê–¢–¨ –°–ù–û–í–ê
            </button>
        </div>
    </div>

    <!-- –°–û–û–ë–©–ï–ù–ò–ï –û –ü–û–†–ê–ñ–ï–ù–ò–ò -->
    <div class="message-overlay" id="loseMessage">
        <div class="message-box" style="border-color: #ff5555;">
            <div class="message-title lose-title">‚õΩ –¢–û–ü–õ–ò–í–û –ó–ê–ö–û–ù–ß–ò–õ–û–°–¨!</div>
            <div class="message-text">
                –†–∞–∫–µ—Ç–∞ –Ω–µ —Å–º–æ–≥–ª–∞ –¥–æ–ª–µ—Ç–µ—Ç—å –¥–æ –õ—É–Ω—ã...
                –ù–æ —Ç—ã –º–æ–∂–µ—à—å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞!
            </div>
            <div class="message-stats" id="loseStats">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ -->
            </div>
            <button class="message-btn" onclick="closeMessage('loseMessage'); resetGame();">
                <i class="fas fa-redo"></i> –ü–û–ü–†–û–ë–û–í–ê–¢–¨ –°–ù–û–í–ê
            </button>
        </div>
    </div>

    <script>
        // ========== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
        let gameState = {
            level: 1,
            correct: 0,
            wrong: 0,
            fuel: 100,
            stars: 0,
            rocketProgress: 0,
            problemsSolved: 0,
            currentAnswer: 0,
            maxWrong: 3,
            rocketPosition: 0,
            moonDistance: 300
        };

        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´ ==========
        function initGame() {
            createStarfield();
            createSpaceStars();
            resetGame();
        }

        // ========== –°–û–ó–î–ê–ù–ò–ï –ó–í–ï–ó–î–ù–û–ì–û –ü–û–õ–Ø ==========
        function createStarfield() {
            const starfield = document.getElementById('starfield');
            starfield.innerHTML = '';

            for (let i = 0; i < 150; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.cssText = `
                    width: ${Math.random() * 3 + 1}px;
                    height: ${Math.random() * 3 + 1}px;
                    left: ${Math.random() * 100}%;
                    top: ${Math.random() * 100}%;
                    opacity: ${Math.random() * 0.5 + 0.2};
                    animation-duration: ${Math.random() * 2 + 1}s;
                    animation-delay: ${Math.random() * 2}s;
                `;
                starfield.appendChild(star);
            }
        }

        // ========== –°–û–ó–î–ê–ù–ò–ï –ó–í–ï–ó–î –ù–ê –ü–£–¢–ò ==========
        function createSpaceStars() {
            const spaceStars = document.getElementById('spaceStars');
            spaceStars.innerHTML = '';

            // –°–æ–∑–¥–∞–µ–º 10 –∑–≤–µ–∑–¥ –Ω–∞ –ø—É—Ç–∏ –∫ –ª—É–Ω–µ
            for (let i = 1; i <= 10; i++) {
                const star = document.createElement('div');
                star.className = 'floating-star';
                star.id = `spaceStar${i}`;
                star.style.cssText = `
                    width: ${20 + Math.random() * 10}px;
                    height: ${20 + Math.random() * 10}px;
                    left: ${40 + Math.random() * 40}%;
                    top: ${(i * 30) + Math.random() * 10}px;
                    animation-delay: ${Math.random() * 5}s;
                    opacity: 0.3;
                `;
                star.innerHTML = '‚≠ê';
                spaceStars.appendChild(star);
            }
        }

        // ========== –ì–ï–ù–ï–†–ê–¶–ò–Ø –ü–†–ò–ú–ï–†–û–í ==========
        function generateProblem() {
            let a, b, operator, answer;
            const maxNumber = 5 + gameState.level * 5;
            const operationChance = Math.random();

            // –í—ã–±–∏—Ä–∞–µ–º –æ–ø–µ—Ä–∞—Ü–∏—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è
            let operations;
            if (gameState.level <= 2) {
                operations = ['+', '-'];
            } else if (gameState.level <= 4) {
                operations = ['+', '-', '√ó'];
            } else {
                operations = ['+', '-', '√ó', '√∑'];
            }

            const operation = operations[Math.floor(Math.random() * operations.length)];

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —á–∏—Å–ª–∞ –∏ –æ—Ç–≤–µ—Ç
            switch(operation) {
                case '+':
                    a = Math.floor(Math.random() * maxNumber) + 1;
                    b = Math.floor(Math.random() * maxNumber) + 1;
                    answer = a + b;
                    break;
                case '-':
                    a = Math.floor(Math.random() * maxNumber) + 1;
                    b = Math.floor(Math.random() * a) + 1;
                    answer = a - b;
                    break;
                case '√ó':
                    a = Math.floor(Math.random() * Math.min(10, gameState.level + 2)) + 1;
                    b = Math.floor(Math.random() * Math.min(10, gameState.level + 2)) + 1;
                    answer = a * b;
                    break;
                case '√∑':
                    b = Math.floor(Math.random() * Math.min(10, gameState.level + 2)) + 1;
                    answer = Math.floor(Math.random() * Math.min(10, gameState.level + 2)) + 1;
                    a = b * answer;
                    break;
            }

            gameState.currentAnswer = answer;

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            document.getElementById('problemDisplay').innerHTML = `
                <span style="color: #00ffff;">${a}</span>
                <span style="color: #ffff00; margin: 0 20px;">${operation}</span>
                <span style="color: #00ffaa;">${b}</span>
                <span style="color: white; margin: 0 20px;">=</span>
                <span style="color: #ff00ff;">?</span>
            `;

            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Ä–æ–≤–Ω–µ
            document.getElementById('problemInfo').textContent =
                `–£—Ä–æ–≤–µ–Ω—å ${gameState.level} ‚Ä¢ ${getOperationName(operation)} ‚Ä¢ +${getStarsForAnswer()} –∑–≤–µ–∑–¥ –∑–∞ –æ—Ç–≤–µ—Ç`;

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
            generateAnswers(answer, maxNumber);
        }

        function getOperationName(op) {
            const names = {
                '+': '—Å–ª–æ–∂–µ–Ω–∏–µ',
                '-': '–≤—ã—á–∏—Ç–∞–Ω–∏–µ',
                '√ó': '—É–º–Ω–æ–∂–µ–Ω–∏–µ',
                '√∑': '–¥–µ–ª–µ–Ω–∏–µ'
            };
            return names[op] || '–ø—Ä–∏–º–µ—Ä—ã';
        }

        function getStarsForAnswer() {
            if (gameState.level <= 2) return 1;
            if (gameState.level <= 4) return 2;
            return 3;
        }

        // ========== –ì–ï–ù–ï–†–ê–¶–ò–Ø –û–¢–í–ï–¢–û–í ==========
        function generateAnswers(correctAnswer, maxNumber) {
            const answersGrid = document.getElementById('answersGrid');
            answersGrid.innerHTML = '';

            const answers = new Set([correctAnswer]);

            // –î–æ–±–∞–≤–ª—è–µ–º 3 –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–∞
            while (answers.size < 4) {
                let wrongAnswer;
                const attempts = 0;
                do {
                    // –°–æ–∑–¥–∞–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                    const offset = Math.floor(Math.random() * Math.max(2, gameState.level)) + 1;
                    const sign = Math.random() > 0.5 ? 1 : -1;
                    wrongAnswer = correctAnswer + (sign * offset);

                    // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                    if (wrongAnswer < 0) wrongAnswer = Math.abs(wrongAnswer) + 1;
                    if (wrongAnswer > maxNumber * 2) wrongAnswer = Math.floor(correctAnswer / 2) || 1;

                } while (answers.has(wrongAnswer));
                answers.add(wrongAnswer);
            }

            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –º–∞—Å—Å–∏–≤ –∏ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º
            const answersArray = Array.from(answers);
            for (let i = answersArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [answersArray[i], answersArray[j]] = [answersArray[j], answersArray[i]];
            }

            // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤
            answersArray.forEach(answer => {
                const button = document.createElement('button');
                button.className = 'answer-btn';
                button.textContent = answer;
                button.onclick = () => checkAnswer(answer, button);
                answersGrid.appendChild(button);
            });
        }

        // ========== –ü–†–û–í–ï–†–ö–ê –û–¢–í–ï–¢–ê ==========
        function checkAnswer(answer, button) {
            if (answer === gameState.currentAnswer) {
                // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                handleCorrectAnswer(button);
            } else {
                // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                handleWrongAnswer(button);
            }
        }

        function handleCorrectAnswer(button) {
            // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
            button.classList.add('correct');

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            gameState.correct++;
            gameState.problemsSolved++;
            gameState.fuel = Math.min(100, gameState.fuel + 20);
            gameState.rocketProgress += 20;

            // –î–æ–±–∞–≤–ª—è–µ–º –∑–≤–µ–∑–¥—ã
            const starsEarned = getStarsForAnswer();
            gameState.stars += starsEarned;
            createStarEffect(starsEarned);

            // –î–≤–∏–≥–∞–µ–º —Ä–∞–∫–µ—Ç—É
            moveRocket();

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            checkAchievements();

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Ä–æ–≤–µ–Ω—å
            if (gameState.problemsSolved % 5 === 0) {
                gameState.level++;
                showLevelUpMessage();
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–±–µ–¥—É
            if (gameState.rocketProgress >= gameState.moonDistance) {
                setTimeout(() => endGame(true), 1000);
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateDisplay();

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É
            setTimeout(() => {
                generateProblem();
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∏–ª—å –∫–Ω–æ–ø–∫–∏
                if (button) button.classList.remove('correct');
            }, 1000);
        }

        function handleWrongAnswer(button) {
            // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
            button.classList.add('wrong');

            // –ù–∞—Ö–æ–¥–∏–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É
            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(btn => {
                if (parseInt(btn.textContent) === gameState.currentAnswer) {
                    btn.classList.add('correct');
                }
            });

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            gameState.wrong++;
            gameState.fuel = Math.max(0, gameState.fuel - 25);
            gameState.rocketProgress = Math.max(0, gameState.rocketProgress - 15);

            // –î–≤–∏–≥–∞–µ–º —Ä–∞–∫–µ—Ç—É –Ω–∞–∑–∞–¥
            moveRocket();

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Ä–∞–∂–µ–Ω–∏–µ
            if (gameState.wrong >= gameState.maxWrong || gameState.fuel <= 0) {
                setTimeout(() => endGame(false), 1500);
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateDisplay();

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                generateProblem();
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–æ–∫
                buttons.forEach(btn => {
                    btn.classList.remove('correct', 'wrong');
                });
            }, 1500);
        }

        // ========== –ü–†–û–í–ï–†–ö–ê –í–í–û–î–ê –° –ö–õ–ê–í–ò–ê–¢–£–†–´ ==========
        function checkInputAnswer() {
            const input = document.getElementById('answerInput');
            const answer = parseInt(input.value);

            if (!isNaN(answer)) {
                // –ù–∞—Ö–æ–¥–∏–º –∫–Ω–æ–ø–∫—É —Å —Ç–∞–∫–∏–º –æ—Ç–≤–µ—Ç–æ–º –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é
                const buttons = document.querySelectorAll('.answer-btn');
                let foundButton = null;

                buttons.forEach(btn => {
                    if (parseInt(btn.textContent) === answer) {
                        foundButton = btn;
                    }
                });

                if (foundButton) {
                    checkAnswer(answer, foundButton);
                } else {
                    // –°–æ–∑–¥–∞–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
                    checkAnswer(answer, null);
                }

                input.value = '';
                input.focus();
            }
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                checkInputAnswer();
            }
        }

        // ========== –î–í–ò–ñ–ï–ù–ò–ï –†–ê–ö–ï–¢–´ ==========
        function moveRocket() {
            const rocketContainer = document.getElementById('rocketContainer');
            const progressPercent = (gameState.rocketProgress / gameState.moonDistance) * 100;
            const newPosition = Math.min(100, progressPercent);

            // –í—ã—á–∏—Å–ª—è–µ–º –Ω–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é (–æ—Ç 0 –¥–æ 100%)
            rocketContainer.style.bottom = `${30 + (newPosition * 2.2)}px`;

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –∑–≤–µ–∑–¥—ã –Ω–∞ –ø—É—Ç–∏
            updateSpaceStars();
        }

        function updateSpaceStars() {
            const progressPercent = (gameState.rocketProgress / gameState.moonDistance) * 100;

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–≤–µ–∑–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –ø—Ä–æ–π–¥–µ–Ω—ã
            for (let i = 1; i <= 10; i++) {
                const star = document.getElementById(`spaceStar${i}`);
                if (star) {
                    const starPosition = i * 10; // –ö–∞–∂–¥–∞—è –∑–≤–µ–∑–¥–∞ –Ω–∞ 10% –ø—É—Ç–∏
                    if (progressPercent >= starPosition) {
                        star.style.opacity = '1';
                        star.style.transform = 'scale(1.2)';
                    } else {
                        star.style.opacity = '0.3';
                        star.style.transform = 'scale(1)';
                    }
                }
            }
        }

        // ========== –≠–§–§–ï–ö–¢–´ –ó–í–ï–ó–î ==========
        function createStarEffect(count) {
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const star = document.createElement('div');
                    star.className = 'star-effect';
                    star.innerHTML = '‚≠ê';
                    star.style.cssText = `
                        position: fixed;
                        top: ${Math.random() * 100}%;
                        left: ${Math.random() * 100}%;
                        font-size: ${20 + Math.random() * 20}px;
                        z-index: 1000;
                        pointer-events: none;
                    `;
                    document.body.appendChild(star);

                    // –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
                    setTimeout(() => {
                        star.remove();
                    }, 1000);
                }, i * 200);
            }
        }

        // ========== –û–ë–ù–û–í–õ–ï–ù–ò–ï –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø ==========
        function updateDisplay() {
            document.getElementById('levelValue').textContent = gameState.level;
            document.getElementById('correctValue').textContent = gameState.correct;
            document.getElementById('wrongValue').textContent = `${gameState.wrong}/${gameState.maxWrong}`;
            document.getElementById('starsValue').textContent = gameState.stars;
            document.getElementById('fuelPercent').textContent = `${Math.round(gameState.fuel)}%`;
            document.getElementById('fuelFill').style.width = `${gameState.fuel}%`;

            // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç —Ç–æ–ø–ª–∏–≤–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è
            const fuelFill = document.getElementById('fuelFill');
            if (gameState.fuel > 70) {
                fuelFill.style.background = 'linear-gradient(90deg, #00ff00, #00ffaa)';
            } else if (gameState.fuel > 30) {
                fuelFill.style.background = 'linear-gradient(90deg, #ffff00, #ffaa00)';
            } else {
                fuelFill.style.background = 'linear-gradient(90deg, #ff0000, #ff5500)';
            }
        }

        // ========== –°–û–û–ë–©–ï–ù–ò–Ø ==========
        function showLevelUpMessage() {
            const message = `üéâ –£–†–û–í–ï–ù–¨ ${gameState.level}!\n–¢–µ–ø–µ—Ä—å –ø—Ä–∏–º–µ—Ä—ã –±—É–¥—É—Ç —Å–ª–æ–∂–Ω–µ–µ!\n+1 –∑–≤–µ–∑–¥–∞ –∑–∞ –∫–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç!`;
            showHint(message, 'üìà –ü–û–í–´–®–ï–ù–ò–ï –£–†–û–í–ù–Ø!');
        }

        function showHint(text, title) {
            // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            const hint = document.createElement('div');
            hint.className = 'hint-message';
            hint.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 40, 0.95);
                color: white;
                padding: 30px;
                border-radius: 20px;
                border: 3px solid #00ffff;
                box-shadow: 0 0 40px #00ffff;
                z-index: 2000;
                text-align: center;
                min-width: 300px;
                backdrop-filter: blur(10px);
                animation: messageAppear 0.5s;
            `;

            hint.innerHTML = `
                <div style="color: #00ffff; font-size: 1.5rem; margin-bottom: 10px;">${title}</div>
                <div style="font-size: 1.2rem;">${text}</div>
            `;

            document.body.appendChild(hint);

            setTimeout(() => {
                hint.remove();
            }, 2000);
        }

        // ========== –î–û–°–¢–ò–ñ–ï–ù–ò–Ø ==========
        function checkAchievements() {
            // 3 –ø—Ä–∏–º–µ—Ä–∞
            if (gameState.problemsSolved >= 3) {
                document.getElementById('achieve1').classList.add('unlocked');
            }

            // 5 –ø—Ä–∏–º–µ—Ä–æ–≤
            if (gameState.problemsSolved >= 5) {
                document.getElementById('achieve2').classList.add('unlocked');
            }

            // 10 –ø—Ä–∏–º–µ—Ä–æ–≤
            if (gameState.problemsSolved >= 10) {
                document.getElementById('achieve3').classList.add('unlocked');
            }

            // –£—Ä–æ–≤–µ–Ω—å 3 (–æ—Å—Ç–∞–≤–ª—è–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ–º)
            if (gameState.level >= 3) {
                // –ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç—Ç–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ
                // –ù–∞–ø—Ä–∏–º–µ—Ä: "–†–µ—à–∏—Ç—å 20 –ø—Ä–∏–º–µ—Ä–æ–≤" –∏–ª–∏ "–ù–∞–±—Ä–∞—Ç—å 50 –∑–≤—ë–∑–¥"
            }

            // –ù–µ—Ç –æ—à–∏–±–æ–∫ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ä–µ—à–∏–ª–∏ —Ö–æ—Ç—è –±—ã 5 –ø—Ä–∏–º–µ—Ä–æ–≤)
            if (gameState.wrong === 0 && gameState.problemsSolved >= 5) {
                document.getElementById('achieve5').classList.add('unlocked');
            }
        }

        // ========== –ö–û–ù–ï–¶ –ò–ì–†–´ ==========
        function endGame(win) {
            if (win) {
                // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "–î–æ–ª–µ—Ç–µ—Ç—å –¥–æ –õ—É–Ω—ã"
                document.getElementById('achieve4').classList.add('unlocked');

                // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø–æ–ª–µ—Ç–∞
                const rocket = document.getElementById('rocket');
                rocket.classList.add('rocket-launch');

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–µ
                setTimeout(() => {
                    document.getElementById('winStats').innerHTML = `
                        ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ${gameState.correct}<br>
                        ‚≠ê –°–æ–±—Ä–∞–Ω–æ –∑–≤—ë–∑–¥: ${gameState.stars}<br>
                        üåï –î–æ—Å—Ç–∏–≥–Ω—É—Ç —É—Ä–æ–≤–µ–Ω—å: ${gameState.level}<br>
                        <br>
                        üéÅ –ù–∞–≥—Ä–∞–¥–∞: +${Math.floor(gameState.stars * 1.5)} –∑–≤—ë–∑–¥!
                    `;
                    showMessage('winMessage');

                    // –ù–∞—á–∏—Å–ª—è–µ–º –∑–≤—ë–∑–¥—ã
                    awardStars(Math.floor(gameState.stars * 1.5), '–ü–æ–±–µ–¥–∞ –≤ –ö–æ—Å–º–∏—á–µ—Å–∫–æ–º —Å—á—ë—Ç–µ');
                }, 2000);
            } else {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ—Ä–∞–∂–µ–Ω–∏–∏
                document.getElementById('loseStats').innerHTML = `
                    ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ${gameState.correct}<br>
                    ‚ùå –û—à–∏–±–æ–∫: ${gameState.wrong}<br>
                    ‚≠ê –°–æ–±—Ä–∞–Ω–æ –∑–≤—ë–∑–¥: ${gameState.stars}<br>
                    <br>
                    üéÅ –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ —É—á–∞—Å—Ç–∏–µ: +${Math.floor(gameState.stars / 2)} –∑–≤—ë–∑–¥!
                `;
                showMessage('loseMessage');

                // –ù–∞—á–∏—Å–ª—è–µ–º –∑–≤—ë–∑–¥—ã –∑–∞ —É—á–∞—Å—Ç–∏–µ
                awardStars(Math.floor(gameState.stars / 2), '–£—á–∞—Å—Ç–∏–µ –≤ –ö–æ—Å–º–∏—á–µ—Å–∫–æ–º —Å—á—ë—Ç–µ');
            }
        }

        function showMessage(messageId) {
            document.getElementById(messageId).style.display = 'flex';
        }

        function closeMessage(messageId) {
            document.getElementById(messageId).style.display = 'none';
        }

        // ========== –ù–ê–ß–ò–°–õ–ï–ù–ò–ï –ó–í–Å–ó–î ==========
        async function awardStars(count, reason) {
            try {
                const response = await fetch('/add_star', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        count: count,
                        reason: reason
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    console.log(`–ù–∞—á–∏—Å–ª–µ–Ω–æ ${count} –∑–≤—ë–∑–¥. –í—Å–µ–≥–æ: ${data.stars}`);
                }
            } catch (error) {
                console.log('–û—à–∏–±–∫–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∑–≤—ë–∑–¥:', error);
            }
        }

        // ========== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ò–ì–†–û–ô ==========
        function generateNewProblem() {
            generateProblem();
        }

        function resetGame() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
            gameState = {
                level: 1,
                correct: 0,
                wrong: 0,
                fuel: 100,
                stars: 0,
                rocketProgress: 0,
                problemsSolved: 0,
                currentAnswer: 0,
                maxWrong: 3,
                rocketPosition: 0,
                moonDistance: 300
            };

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ä–∞–∫–µ—Ç—É
            const rocketContainer = document.getElementById('rocketContainer');
            rocketContainer.style.bottom = '30px';
            const rocket = document.getElementById('rocket');
            rocket.classList.remove('rocket-launch');

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–≤–µ–∑–¥—ã –Ω–∞ –ø—É—Ç–∏
            updateSpaceStars();

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è (–∫—Ä–æ–º–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ—Ö—Ä–∞–Ω—è–µ–º)
            const achievements = document.querySelectorAll('.achievement');
            achievements.forEach(ach => {
                if (!ach.id.includes('achieve')) return;
                ach.classList.remove('unlocked');
            });

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateDisplay();

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–µ—Ä–≤—ã–π –ø—Ä–∏–º–µ—Ä
            generateProblem();

            // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
            closeMessage('winMessage');
            closeMessage('loseMessage');

            // –§–æ–∫—É—Å–∏—Ä—É–µ–º—Å—è –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
            document.getElementById('answerInput').focus();
        }

        // ========== –ó–ê–ü–£–°–ö –ò–ì–†–´ ==========
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>